import gmpy2
import sympy
import libnum
import datetime
start = datetime.datetime.now().timestamp()
print(start)
d = 19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913
c = 5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804
e = int(0x10001)
# e∗d-1 = k∗ ( p − 1 ) ( q − 1 )
# print(len(bin(e*d-1)))2066-2048=16,相差16位
# 爆破k
p = 0
q = 0
for k in range(pow(2, 15), pow(2, 16)):
    if (e * d - 1) % k == 0:
        phi = (e * d - 1) // k
        p = sympy.prevprime(gmpy2.iroot(phi, 2)[0])
        q = sympy.nextprime(p)

        if (p - 1) * (q - 1) == phi:
            print(p)
            print(q)
            break

n = p * q
m = pow(c, d, n)
flag = libnum.n2s(int(m))
print(flag)
print(datetime.datetime.now().timestamp() - start)
start = datetime.datetime.now().timestamp()
print(sympy.prevprime(
    175519568923034088684614067025118985767562231604216884247920480999252128434214778016586592192024135502988327082031545726001140830045399270368602651199803842578299493715647987657873746695741528173757922492962995788646470101377147630426314279772695832087975032602734975408543264823544053013011461003587499405968))
print(datetime.datetime.now().timestamp() - start)
# 143193611591752210918770476402384783351740028841763223236102885221839966637073188462808195974548579833368313904083095786906479416347681923731100260359652426441593107755892485944809419189348311956308456459523437459969713060653432909873986596042482699670451716296743727525586437248462432327423361080811225075839
# 143193611591752210918770476402384783351740028841763223236102885221839966637073188462808195974548579833368313904083095786906479416347681923731100260359652426441593107755892485944809419189348311956308456459523437459969713060653432909873986596042482699670451716296743727525586437248462432327423361080811225076497
# b'NCTF{70u2_nn47h_14_v3ry_gOO0000000d}'